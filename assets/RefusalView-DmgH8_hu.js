import{V as b}from"./index-BcFhOSVY.js";import{d as D,i as c,c as t,h as x,j as u,b as e,t as y,e as C,k as g,o as n}from"./index-BiZWj2oT.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";const V={class:"article-page"},N={key:0,class:"doc-preview-modal"},E={class:"modal-content"},F={class:"modal-header"},W={class:"modal-body"},L={key:0,class:"docx-container"},R={class:"docx-wrapper"},B={key:1,class:"pdf-container"},I=["src"],T={key:2,class:"unsupported-file"},j={style:{"text-align":"center",padding:"50px"}},O=["href"],S={class:"modal-footer"},U=D({__name:"RefusalView",setup(q){const r=c(!1),o=c(""),l=c(""),d=()=>{r.value=!1,o.value="",l.value=""},_=s=>s.split("/").pop()||"文档",v=s=>s.toLowerCase().endsWith(".docx"),i=s=>s.toLowerCase().endsWith(".pdf"),f=()=>{console.log("Word文档渲染完成")},p=s=>{console.error("Word文档渲染错误:",s),alert("Word文档加载失败，请检查文件路径")},m=()=>{console.log("PDF加载完成")},h=()=>{console.error("PDF加载失败"),alert("PDF文件加载失败，请检查文件路径")},w=()=>{o.value&&window.open(o.value,"_blank")},k=()=>{if(!o.value)return;const s=document.createElement("a");s.href=o.value,s.download=_(o.value),s.click()};return(s,a)=>(n(),t("div",V,[a[1]||(a[1]=x(" 00 ",-1)),r.value?(n(),t("div",N,[e("div",E,[e("div",F,[e("h3",null,y(l.value),1),e("button",{class:"close-btn",onClick:d},"×")]),e("div",W,[v(o.value)?(n(),t("div",L,[e("div",R,[C(g(b),{src:o.value,onRendered:f,onError:p},null,8,["src"])])])):i(o.value)?(n(),t("div",B,[e("iframe",{src:o.value,style:{width:"100%",height:"100%",border:"none"},onLoad:m,onError:h},null,40,I)])):(n(),t("div",T,[e("div",j,[a[0]||(a[0]=e("p",null,"不支持在线预览的文件格式",-1)),e("a",{href:o.value,download:"",class:"download-btn"},"下载文件",8,O)])]))]),e("div",S,[i(o.value)?(n(),t("button",{key:0,class:"new-tab-btn",onClick:w}," 新标签页打开 ")):u("",!0),e("button",{class:"download-btn",onClick:k}," 下载文档 ")])]),e("div",{class:"modal-backdrop",onClick:d})])):u("",!0)]))}}),H=P(U,[["__scopeId","data-v-7f54b4a6"]]);export{H as default};
