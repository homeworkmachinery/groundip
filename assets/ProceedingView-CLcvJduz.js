import{V as b}from"./index-BcFhOSVY.js";import{d as D,i as c,c as n,j as u,b as o,t as g,e as x,k as P,o as t}from"./index-BiZWj2oT.js";import{_ as y}from"./_plugin-vue_export-helper-DlAUqK2U.js";const C={class:"proceeding-page"},V={key:0,class:"doc-preview-modal"},E={class:"modal-content"},F={class:"modal-header"},N={class:"modal-body"},W={key:0,class:"docx-container"},L={class:"docx-wrapper"},B={key:1,class:"pdf-container"},I=["src"],R={key:2,class:"unsupported-file"},j={style:{"text-align":"center",padding:"50px"}},O=["href"],S={class:"modal-footer"},T=D({__name:"ProceedingView",setup(U){const r=c(!1),e=c(""),a=c(""),d=()=>{r.value=!1,e.value="",a.value=""},_=s=>s.split("/").pop()||"文档",v=s=>s.toLowerCase().endsWith(".docx"),l=s=>s.toLowerCase().endsWith(".pdf"),p=()=>{console.log("Word文档渲染完成")},f=s=>{console.error("Word文档渲染错误:",s),alert("Word文档加载失败，请检查文件路径")},m=()=>{console.log("PDF加载完成")},h=()=>{console.error("PDF加载失败"),alert("PDF文件加载失败，请检查文件路径")},w=()=>{e.value&&window.open(e.value,"_blank")},k=()=>{if(!e.value)return;const s=document.createElement("a");s.href=e.value,s.download=_(e.value),s.click()};return(s,i)=>(t(),n("div",C,[r.value?(t(),n("div",V,[o("div",E,[o("div",F,[o("h3",null,g(a.value),1),o("button",{class:"close-btn",onClick:d},"×")]),o("div",N,[v(e.value)?(t(),n("div",W,[o("div",L,[x(P(b),{src:e.value,onRendered:p,onError:f},null,8,["src"])])])):l(e.value)?(t(),n("div",B,[o("iframe",{src:e.value,style:{width:"100%",height:"100%",border:"none"},onLoad:m,onError:h},null,40,I)])):(t(),n("div",R,[o("div",j,[i[0]||(i[0]=o("p",null,"不支持在线预览的文件格式",-1)),o("a",{href:e.value,download:"",class:"download-btn"},"下载文件",8,O)])]))]),o("div",S,[l(e.value)?(t(),n("button",{key:0,class:"new-tab-btn",onClick:w}," 新标签页打开 ")):u("",!0),o("button",{class:"download-btn",onClick:k}," 下载文档 ")])]),o("div",{class:"modal-backdrop",onClick:d})])):u("",!0)]))}}),G=y(T,[["__scopeId","data-v-9442dd87"]]);export{G as default};
