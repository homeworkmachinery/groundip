import{V as b}from"./index-BcFhOSVY.js";import{d as D,i as c,c as t,j as u,b as e,t as x,e as y,k as C,o as n}from"./index-BiZWj2oT.js";import{_ as g}from"./_plugin-vue_export-helper-DlAUqK2U.js";const P={class:"article-page"},V={key:0,class:"doc-preview-modal"},E={class:"modal-content"},F={class:"modal-header"},N={class:"modal-body"},W={key:0,class:"docx-container"},L={class:"docx-wrapper"},B={key:1,class:"pdf-container"},A=["src"],I={key:2,class:"unsupported-file"},R={style:{"text-align":"center",padding:"50px"}},j=["href"],O={class:"modal-footer"},S=D({__name:"ArticleView",setup(T){const a=c(!1),o=c(""),r=c(""),l=()=>{a.value=!1,o.value="",r.value=""},_=s=>s.split("/").pop()||"文档",v=s=>s.toLowerCase().endsWith(".docx"),d=s=>s.toLowerCase().endsWith(".pdf"),p=()=>{console.log("Word文档渲染完成")},f=s=>{console.error("Word文档渲染错误:",s),alert("Word文档加载失败，请检查文件路径")},m=()=>{console.log("PDF加载完成")},h=()=>{console.error("PDF加载失败"),alert("PDF文件加载失败，请检查文件路径")},w=()=>{o.value&&window.open(o.value,"_blank")},k=()=>{if(!o.value)return;const s=document.createElement("a");s.href=o.value,s.download=_(o.value),s.click()};return(s,i)=>(n(),t("div",P,[a.value?(n(),t("div",V,[e("div",E,[e("div",F,[e("h3",null,x(r.value),1),e("button",{class:"close-btn",onClick:l},"×")]),e("div",N,[v(o.value)?(n(),t("div",W,[e("div",L,[y(C(b),{src:o.value,onRendered:p,onError:f},null,8,["src"])])])):d(o.value)?(n(),t("div",B,[e("iframe",{src:o.value,style:{width:"100%",height:"100%",border:"none"},onLoad:m,onError:h},null,40,A)])):(n(),t("div",I,[e("div",R,[i[0]||(i[0]=e("p",null,"不支持在线预览的文件格式",-1)),e("a",{href:o.value,download:"",class:"download-btn"},"下载文件",8,j)])]))]),e("div",O,[d(o.value)?(n(),t("button",{key:0,class:"new-tab-btn",onClick:w}," 新标签页打开 ")):u("",!0),e("button",{class:"download-btn",onClick:k}," 下载文档 ")])]),e("div",{class:"modal-backdrop",onClick:l})])):u("",!0)]))}}),G=g(S,[["__scopeId","data-v-137fe93e"]]);export{G as default};
